# VERIFY OPEN PORTS
# List iptables rules for INPUT chain:
iptables -S INPUT | grep ACCEPT

# Check which ports are listening (replace 8804 with your port if needed):
sudo ss -ltnup | egrep ':80|:443|:25565|:19132|:19133|:8804' || true

# Test from another machine (replace <server_ip> and <port>):
#
#   nc -vz <server_ip> 8804
#   nc -vz <server_ip> 443
#   nc -vz <server_ip> 80

# TROUBLESHOOTING & CURL TESTS
# Test Plan web UI port locally:
curl -vL http://localhost:8804
# You should see a 302 redirect and then a 200 OK with HTML content.
# If not, check:
#   - Plan is running and listening (sudo ss -ltnp | grep 8804)
#   - Plan logs for errors (plugins/Plan/logs/latest.log)
#   - Minecraft server is running and Plan is enabled
#   - Plan config.yml has correct port and IP

# Test Nginx proxy ports locally:
curl -vI http://localhost
curl -vI https://localhost --insecure
# You should see HTTP/1.1 301 or 200 and Nginx/Plan headers.
# If not, check:
#   - Nginx is running (sudo systemctl status nginx)
#   - Nginx config for correct proxy settings
#   - SSL certificate files exist for HTTPS


Apply firewall rules on Ubuntu server running on Oracle Cloud. 

vim /etc/iptables/rules.v4

Find the line that allows SSH (22), then add these lines right after it (IMPORTANT: before the REJECT line). 


-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 25565 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m udp --dport 25565 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 8804 -j ACCEPT
-A INPUT -p udp -m udp --dport 19132 -j ACCEPT
-A INPUT -p udp -m udp --dport 19133 -j ACCEPT


# APPLY CHANGES
iptables-restore < /etc/iptables/rules.v4
netfilter-persistent save


# VERIFICATION
iptables -S INPUT | sed -n '1,40p'
sudo ss -ltnup | egrep ':80|:25565|:19132|:19133' || true


# temp disable port
block port:
sudo iptables -I INPUT -p tcp --dport 25565 -j DROP

enable port:
sudo iptables -D INPUT -p tcp --dport 25565 -j DROP







end